"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(t,!0).forEach(function(e){(0,_defineProperty2.default)(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(t).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}var CommandHandler=function e(r){var i=this;(0,_classCallCheck2.default)(this,e),(0,_defineProperty2.default)(this,"handle",function(){var r=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r){var t,n,a,o,u;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new i.Command(r),e.next=3,t.validate();case 3:return e.next=5,i.authorize(t);case 5:return e.t0=asArray,e.next=8,i.execute(t);case 8:return e.t1=e.sent,n=(0,e.t0)(e.t1),o=(a=n||{}).events,u=(0,_objectWithoutProperties2.default)(a,["events"]),o||(o=n,u=null),(o=asArray(o)).forEach(function(e){e.actor=t.$identity&&t.$identity.userId,e.position=t.$position}),e.abrupt("return",_objectSpread({events:o},u));case 15:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}()),(0,_defineProperty2.default)(this,"execute",function(){var r=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r){return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}()),(0,_defineProperty2.default)(this,"authorize",function(){var r=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r){return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}()),(0,_defineProperty2.default)(this,"handleDeliveryError",function(){var r=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r){return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(e){return r.apply(this,arguments)}}()),this.Command=r};function asArray(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return(Array.isArray(e)?e:[e]).filter(function(e){return!!e})}exports.default=CommandHandler;
//# sourceMappingURL=../maps/commandHandling/commandHandler.js.map
