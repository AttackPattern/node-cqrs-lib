"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=check;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_construct2=_interopRequireDefault(require("@babel/runtime/helpers/construct")),_authorizationError=_interopRequireDefault(require("./authorizationError"));function check(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.rights,i=void 0===r?[]:r,t=e.message,o=void 0===t?"User is not allowed to issue this command":t,n=e.features,s=void 0===n?[]:n;return function(a,e,r){return function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var n=(0,_construct2.default)(a,r),u=n.authorize;return n.authorize=function(){var t=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function e(r,t){return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.$identity.isSystem()){e.next=2;break}return e.abrupt("return",n);case 2:if(i.some(function(e){return r.$identity.rights.includes(e)})||s.some(function(e){return r.$identity.features.includes(e)})){e.next=4;break}throw new _authorizationError.default({aggregate:t,command:r,message:o});case 4:if(!u){e.next=7;break}return e.next=7,u(r,t);case 7:case"end":return e.stop()}},e)}));return function(e,r){return t.apply(this,arguments)}}(),n}}}
//# sourceMappingURL=../maps/auth/authorizeDecorator.js.map
